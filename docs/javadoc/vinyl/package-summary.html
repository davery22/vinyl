<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (19) on Tue Nov 15 16:40:49 MST 2022 -->
<title>vinyl</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="dc.created" content="2022-11-15">
<meta name="description" content="declaration: package: vinyl">
<meta name="generator" content="javadoc/PackageWriterImpl">
<link rel="stylesheet" type="text/css" href="../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../script-dir/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../script.js"></script>
<script type="text/javascript" src="../script-dir/jquery-3.6.0.min.js"></script>
<script type="text/javascript" src="../script-dir/jquery-ui.min.js"></script>
</head>
<body class="package-declaration-page">
<script type="text/javascript">var pathtoroot = "../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon"></span><span class="nav-bar-toggle-icon"></span><span class="nav-bar-toggle-icon"></span></button>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li class="nav-bar-cell1-rev">Package</li>
<li>Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../index-files/index-1.html">Index</a></li>
<li><a href="../help-doc.html#package">Help</a></li>
</ul>
<ul class="sub-nav-list-small">
<li>
<p>Package:</p>
<ul>
<li><a href="#package-description">Description</a></li>
<li>Related Packages</li>
<li><a href="#class-summary">Classes and Interfaces</a></li>
</ul>
</li>
</ul>
</div>
<div class="sub-nav">
<div id="navbar-sub-list">
<ul class="sub-nav-list">
<li>Package:&nbsp;</li>
<li><a href="#package-description">Description</a>&nbsp;|&nbsp;</li>
<li>Related Packages&nbsp;|&nbsp;</li>
<li><a href="#class-summary">Classes and Interfaces</a></li>
</ul>
</div>
<div class="nav-list-search"><label for="search-input">SEARCH:</label>
<input type="text" id="search-input" disabled placeholder="Search">
<input type="reset" id="reset-button" disabled value="reset">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<div class="header">
<h1 title="Package vinyl" class="title">Package vinyl</h1>
</div>
<hr>
<div class="package-signature">package <span class="element-name">vinyl</span></div>
<section class="package-description" id="package-description">
<div class="block">Classes to support relational-style operations on streams of elements, such as select, aggregate, and join
 transformations. The elements are represented as immutable "record" objects, which have their "fields" defined by a
 relational operation, rather than a class declaration. For example:

 <pre><code>
     Field&lt;Long&gt; userAge = new Field&lt;&gt;("userAge");
     Field&lt;Long&gt; userAccountAge = new Field&lt;&gt;("userAccountAge");
     Field&lt;Long&gt; countUsers = new Field&lt;&gt;("countUsers");
     Field&lt;Double&gt; avgAccountAge = new Field&lt;&gt;("avgAccountAge");

     RecordSet data = RecordStream.aux(users.stream())
         .mapToRecord(into -&gt; into
             .field(userAge, user -&gt; ChronoUnit.YEARS.between(user.getBirthDate(), LocalDate.now()))
             .field(userAccountAge, user -&gt; ChronoUnit.YEARS.between(user.getAccountStartDate(), LocalDate.now()))
         )
         .aggregate(aggregate -&gt; aggregate
             .keyField(userAge)
             .aggField(countUsers, Collectors.counting())
             .aggField(avgAccountAge, Collectors.averagingLong(record -&gt; record.get(userAccountAge))
         )
         .toRecordSet();
 </code></pre>

 <p>Here we first define a few fields to use in subsequent relational operations, giving types for those fields. Then we
 take a stream of <code>users</code>, transform it to a stream of records, and perform a grouped aggregation yielding a new
 stream of records, which we finally collect into a <code>RecordSet</code>.

 <h2><a id="Records">Records, Headers, and Fields</a></h2>

 <p><code>Record</code> is an essential abstraction in Vinyl. A record is a shallowly-immutable carrier for a fixed set of
 values, not unlike a <code>java.lang.Record</code> in Java 16+. However, Vinyl Records are not open to extension, and do
 not declare any fields on the class. Instead, records are internally instantiated with a <code>Header</code> and a set of
 values. The header defines what "fields" the record contains, and the values correspond to those fields. This allows
 relational operations to dynamically define new combinations of fields for resulting records.

 <p>Each "field" in the record header is represented as a <code>Field</code>. A field is an opaque object with a
 parameterized type - the type of values that a record may associate with that field. The field is used to access its
 value on a record, similar to how normal fields are used to access values on an object. This ensures value access is
 type-safe.

 <h2><a id="Aux">Auxiliary Streams</a></h2>

 <p>In the above "user aggregate" example, we first had to wrap the default <code>Stream</code> of users in a
 <code>RecordStream.Aux</code>. This wrapper-stream extends the default stream with the <code>mapToRecord()</code> method, which
 enables transformation into a <code>RecordStream</code>. Rather than have a static method to do this, using a
 wrapper-stream allows for going back and forth between the stream types seamlessly. Other wrapper-stream types are
 provided for each of the primitive stream types, ie <code>RecordStream.AuxInt</code>, <code>RecordStream.AuxLong</code>, and
 <code>RecordStream.AuxDouble</code>. Existing stream operations that return a stream are overridden to return one of these
 wrapper types.

 <h2><a id="RecordStreams">RecordStreams and RecordSets</a></h2>

 <p>A <code>RecordStream</code> is a stream of records sharing the same header. Record-streams extend normal streams with
 relational operations like <code>select()</code>, <code>aggregate()</code>, and <code>join()</code>, which transform the header and
 records in the stream.

 <p>A <code>RecordSet</code> stores records sharing the same header. Record-streams can be collected into record-sets,
 allowing the records to be trivially re-streamed later, possibly multiple times.

 <h2><a id="Configurators">Configurators</a></h2>

 <p>Relational operations on a record-stream expose "configurators", which configure how the operation is executed. For
 example, configurators are used to define the output fields of a <code>select()</code> operation, the join condition of a
 <code>join()</code> operation, and the grouping keys of an <code>aggregate()</code> operation. Configurators may expose
 sub-configurators for handling isolated specifics of the overall operation. To demonstrate:

 <pre><code>
     scoresStream
         .select(select -&gt; select
             .field(points)
             .window(window -&gt; window
                 .field(averagePoints, Analytics.fromAgg(Collectors.averagingLong(points::get)))
                 .fields(Comparator.comparingLong(points::get), fields -&gt; fields
                     .field(discreteMedian, Analytics.percentileDisc(0.5, points::get))
                     .field(continuousMedian, Analytics.percentileCont(0.5, points::get))
                 )
             )
         )
 </code></pre>

 <p>Here, the <code>select</code>, <code>window</code>, and <code>fields</code> configurators (named after the methods that introduce
 them) are used to configure the overall <code>select()</code> operation. The <code>window</code> configurator is a
 sub-configurator of <code>select</code>, and the <code>fields</code> configurator is a sub-configurator of <code>window</code>.
 Together these configurators define four fields <code>[points, averagePoints, discreteMedian, continuousMedian]</code> on
 the resultant record-stream.</div>
</section>
<section class="summary">
<ul class="summary-list">
<li>
<div id="class-summary">
<div class="caption"><span>Classes</span></div>
<div class="summary-table two-column-summary">
<div class="table-header col-first">Class</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color class-summary class-summary-tab2"><a href="AggregateAPI.html" title="class in vinyl">AggregateAPI</a></div>
<div class="col-last even-row-color class-summary class-summary-tab2">
<div class="block">A configurator used to define an aggregate operation on a <a href="RecordStream.html" title="class in vinyl"><code>record-stream</code></a>.</div>
</div>
<div class="col-first odd-row-color class-summary class-summary-tab2"><a href="Analytics.html" title="class in vinyl">Analytics</a></div>
<div class="col-last odd-row-color class-summary class-summary-tab2">
<div class="block">Factory methods that create various useful analytic functions, of the form expected by <a href="SelectAPI.Window.html" title="class in vinyl"><code>SelectAPI.Window</code></a>.</div>
</div>
<div class="col-first even-row-color class-summary class-summary-tab2"><a href="Field.html" title="class in vinyl">Field</a>&lt;T&gt;</div>
<div class="col-last even-row-color class-summary class-summary-tab2">
<div class="block">An identifier used to access a typed value in a <a href="Record.html" title="class in vinyl"><code>record</code></a>.</div>
</div>
<div class="col-first odd-row-color class-summary class-summary-tab2"><a href="FieldPin.html" title="class in vinyl">FieldPin</a>&lt;T&gt;</div>
<div class="col-last odd-row-color class-summary class-summary-tab2">
<div class="block">An object that associates a field with a header index, for optimized field value lookup.</div>
</div>
<div class="col-first even-row-color class-summary class-summary-tab2"><a href="Header.html" title="class in vinyl">Header</a></div>
<div class="col-last even-row-color class-summary class-summary-tab2">
<div class="block">An ordered, immutable collection of <a href="Field.html" title="class in vinyl"><code>fields</code></a> belonging to a single <a href="Record.html" title="class in vinyl"><code>record</code></a>, a
 <a href="RecordSet.html" title="class in vinyl"><code>record-set</code></a>, or a <a href="RecordStream.html" title="class in vinyl"><code>record-stream</code></a>.</div>
</div>
<div class="col-first odd-row-color class-summary class-summary-tab2"><a href="IntoAPI.html" title="class in vinyl">IntoAPI</a>&lt;T&gt;</div>
<div class="col-last odd-row-color class-summary class-summary-tab2">
<div class="block">A configurator used to define a conversion from input elements to <a href="Record.html" title="class in vinyl"><code>records</code></a>.</div>
</div>
<div class="col-first even-row-color class-summary class-summary-tab2"><a href="JoinAPI.html" title="class in vinyl">JoinAPI</a></div>
<div class="col-last even-row-color class-summary class-summary-tab2">
<div class="block">A configurator used to define a relational join operation between a left and a right
 <a href="RecordStream.html" title="class in vinyl"><code>record-stream</code></a>.</div>
</div>
<div class="col-first odd-row-color class-summary class-summary-tab2"><a href="JoinExpr.html" title="class in vinyl">JoinExpr</a>&lt;T&gt;</div>
<div class="col-last odd-row-color class-summary class-summary-tab2">
<div class="block">An opaque value representing an expression defined by <a href="JoinAPI.On.html" title="class in vinyl"><code>JoinAPI.On</code></a>.</div>
</div>
<div class="col-first even-row-color class-summary class-summary-tab2"><a href="JoinPred.html" title="class in vinyl">JoinPred</a></div>
<div class="col-last even-row-color class-summary class-summary-tab2">
<div class="block">An opaque value representing a predicate defined by <a href="JoinAPI.On.html" title="class in vinyl"><code>JoinAPI.On</code></a>.</div>
</div>
<div class="col-first odd-row-color class-summary class-summary-tab2"><a href="Record.html" title="class in vinyl">Record</a></div>
<div class="col-last odd-row-color class-summary class-summary-tab2">
<div class="block">A shallowly immutable carrier for a fixed set of values, determined by the record <a href="Header.html" title="class in vinyl"><code>header</code></a>.</div>
</div>
<div class="col-first even-row-color class-summary class-summary-tab2"><a href="RecordSet.html" title="class in vinyl">RecordSet</a></div>
<div class="col-last even-row-color class-summary class-summary-tab2">
<div class="block">An ordered collection of <a href="Record.html" title="class in vinyl"><code>records</code></a> with a common <a href="Header.html" title="class in vinyl"><code>header</code></a>.</div>
</div>
<div class="col-first odd-row-color class-summary class-summary-tab2"><a href="RecordStream.html" title="class in vinyl">RecordStream</a></div>
<div class="col-last odd-row-color class-summary class-summary-tab2">
<div class="block">A stream of <a href="Record.html" title="class in vinyl"><code>records</code></a> with a common <a href="Header.html" title="class in vinyl"><code>header</code></a>.</div>
</div>
<div class="col-first even-row-color class-summary class-summary-tab2"><a href="RecordStream.Aux.html" title="class in vinyl">RecordStream.Aux</a>&lt;T&gt;</div>
<div class="col-last even-row-color class-summary class-summary-tab2">
<div class="block">An auxiliary stream of objects that may readily be converted to or from a <a href="RecordStream.html" title="class in vinyl"><code>record-stream</code></a>.</div>
</div>
<div class="col-first odd-row-color class-summary class-summary-tab2"><a href="RecordStream.AuxDouble.html" title="class in vinyl">RecordStream.AuxDouble</a></div>
<div class="col-last odd-row-color class-summary class-summary-tab2">
<div class="block">An auxiliary stream of doubles that may readily be converted to or from a <a href="RecordStream.html" title="class in vinyl"><code>record-stream</code></a>.</div>
</div>
<div class="col-first even-row-color class-summary class-summary-tab2"><a href="RecordStream.AuxInt.html" title="class in vinyl">RecordStream.AuxInt</a></div>
<div class="col-last even-row-color class-summary class-summary-tab2">
<div class="block">An auxiliary stream of ints that may readily be converted to or from a <a href="RecordStream.html" title="class in vinyl"><code>record-stream</code></a>.</div>
</div>
<div class="col-first odd-row-color class-summary class-summary-tab2"><a href="RecordStream.AuxLong.html" title="class in vinyl">RecordStream.AuxLong</a></div>
<div class="col-last odd-row-color class-summary class-summary-tab2">
<div class="block">An auxiliary stream of longs that may readily be converted to or from a <a href="RecordStream.html" title="class in vinyl"><code>record-stream</code></a>.</div>
</div>
<div class="col-first even-row-color class-summary class-summary-tab2"><a href="SelectAPI.html" title="class in vinyl">SelectAPI</a></div>
<div class="col-last even-row-color class-summary class-summary-tab2">
<div class="block">A configurator used to define a select operation on a <a href="RecordStream.html" title="class in vinyl"><code>record-stream</code></a>.</div>
</div>
</div>
</div>
</li>
</ul>
</section>
</main>
</div>
</div>
</body>
</html>
